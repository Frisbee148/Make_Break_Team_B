{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\amanm\\\\OneDrive\\\\Desktop\\\\final\\\\src\\\\components\\\\SpreadsheetGrid.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from \"react\";\nimport { evaluateFormula } from \"../utils/formula\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction makeEmpty(rows = 20, cols = 10) {\n  return Array.from({\n    length: rows\n  }, () => Array.from({\n    length: cols\n  }, () => \"\"));\n}\nexport default function SpreadsheetGrid({\n  cells,\n  setCells,\n  editable = true\n}) {\n  _s();\n  const [editing, setEditing] = useState(null);\n  const inputRef = useRef();\n  useEffect(() => {\n    if (editing && inputRef.current) inputRef.current.focus();\n  }, [editing]);\n  const rendered = (r, c) => {\n    var _cells$r$c, _cells$r;\n    const val = (_cells$r$c = cells === null || cells === void 0 ? void 0 : (_cells$r = cells[r]) === null || _cells$r === void 0 ? void 0 : _cells$r[c]) !== null && _cells$r$c !== void 0 ? _cells$r$c : \"\";\n    if (typeof val === \"string\" && val.startsWith(\"=\")) {\n      try {\n        const out = evaluateFormula(cells, val);\n        return out;\n      } catch (e) {\n        return \"#ERR\";\n      }\n    }\n    return val;\n  };\n  const handleChange = (r, c, v) => {\n    const copy = cells.map(row => [...row]);\n    copy[r][c] = v;\n    setCells(copy);\n  };\n  const rows = Math.max(20, cells.length || 20);\n  const cols = Math.max(10, cells[0] ? cells[0].length : 10);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"overflow-auto border bg-white\",\n    children: /*#__PURE__*/_jsxDEV(\"table\", {\n      className: \"min-w-full border-collapse\",\n      children: [/*#__PURE__*/_jsxDEV(\"thead\", {\n        children: /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"th\", {\n            className: \"p-1 border bg-slate-100 w-10\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 42,\n            columnNumber: 13\n          }, this), Array.from({\n            length: cols\n          }).map((_, c) => /*#__PURE__*/_jsxDEV(\"th\", {\n            className: \"p-1 border text-center font-medium\",\n            children: String.fromCharCode(65 + c)\n          }, c, false, {\n            fileName: _jsxFileName,\n            lineNumber: 44,\n            columnNumber: 15\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 41,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 40,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n        children: Array.from({\n          length: rows\n        }).map((_, r) => /*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"td\", {\n            className: \"p-1 border text-center\",\n            children: r + 1\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 51,\n            columnNumber: 15\n          }, this), Array.from({\n            length: cols\n          }).map((_, c) => {\n            var _cells$r$c2, _cells$r2, _cells$r$c3, _cells$r3;\n            return /*#__PURE__*/_jsxDEV(\"td\", {\n              className: \"p-0 border\",\n              children: editing && editing.r === r && editing.c === c && editable ? /*#__PURE__*/_jsxDEV(\"input\", {\n                ref: inputRef,\n                className: \"w-full h-8 px-1\",\n                value: (_cells$r$c2 = cells === null || cells === void 0 ? void 0 : (_cells$r2 = cells[r]) === null || _cells$r2 === void 0 ? void 0 : _cells$r2[c]) !== null && _cells$r$c2 !== void 0 ? _cells$r$c2 : \"\",\n                onChange: e => handleChange(r, c, e.target.value),\n                onBlur: () => setEditing(null),\n                onKeyDown: e => {\n                  if (e.key === 'Enter') setEditing(null);\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 55,\n                columnNumber: 21\n              }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"h-8 px-1 text-left cursor-text\",\n                onDoubleClick: () => editable && setEditing({\n                  r,\n                  c\n                }),\n                onClick: () => editable && setEditing({\n                  r,\n                  c\n                }),\n                title: (_cells$r$c3 = cells === null || cells === void 0 ? void 0 : (_cells$r3 = cells[r]) === null || _cells$r3 === void 0 ? void 0 : _cells$r3[c]) !== null && _cells$r$c3 !== void 0 ? _cells$r$c3 : \"\",\n                children: String(rendered(r, c))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 64,\n                columnNumber: 21\n              }, this)\n            }, c, false, {\n              fileName: _jsxFileName,\n              lineNumber: 53,\n              columnNumber: 17\n            }, this);\n          })]\n        }, r, true, {\n          fileName: _jsxFileName,\n          lineNumber: 50,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 48,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 38,\n    columnNumber: 5\n  }, this);\n}\n_s(SpreadsheetGrid, \"LGElXjn1aNh4F+DVCDI4JNG1E5g=\");\n_c = SpreadsheetGrid;\nvar _c;\n$RefreshReg$(_c, \"SpreadsheetGrid\");","map":{"version":3,"names":["React","useState","useEffect","useRef","evaluateFormula","jsxDEV","_jsxDEV","makeEmpty","rows","cols","Array","from","length","SpreadsheetGrid","cells","setCells","editable","_s","editing","setEditing","inputRef","current","focus","rendered","r","c","_cells$r$c","_cells$r","val","startsWith","out","e","handleChange","v","copy","map","row","Math","max","className","children","fileName","_jsxFileName","lineNumber","columnNumber","_","String","fromCharCode","_cells$r$c2","_cells$r2","_cells$r$c3","_cells$r3","ref","value","onChange","target","onBlur","onKeyDown","key","onDoubleClick","onClick","title","_c","$RefreshReg$"],"sources":["C:/Users/amanm/OneDrive/Desktop/final/src/components/SpreadsheetGrid.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport { evaluateFormula } from \"../utils/formula\";\n\nfunction makeEmpty(rows = 20, cols = 10) {\n  return Array.from({ length: rows }, () => Array.from({ length: cols }, () => \"\"));\n}\n\nexport default function SpreadsheetGrid({ cells, setCells, editable=true }) {\n  const [editing, setEditing] = useState(null);\n  const inputRef = useRef();\n\n  useEffect(() => {\n    if (editing && inputRef.current) inputRef.current.focus();\n  }, [editing]);\n\n  const rendered = (r,c) => {\n    const val = cells?.[r]?.[c] ?? \"\";\n    if (typeof val === \"string\" && val.startsWith(\"=\")) {\n      try {\n        const out = evaluateFormula(cells, val);\n        return out;\n      } catch (e) {\n        return \"#ERR\";\n      }\n    }\n    return val;\n  };\n\n  const handleChange = (r,c,v) => {\n    const copy = cells.map(row => [...row]);\n    copy[r][c] = v;\n    setCells(copy);\n  };\n\n  const rows = Math.max(20, cells.length || 20);\n  const cols = Math.max(10, (cells[0] ? cells[0].length : 10));\n  return (\n    <div className=\"overflow-auto border bg-white\">\n      <table className=\"min-w-full border-collapse\">\n        <thead>\n          <tr>\n            <th className=\"p-1 border bg-slate-100 w-10\"></th>\n            {Array.from({length: cols}).map((_,c)=>(\n              <th key={c} className=\"p-1 border text-center font-medium\">{String.fromCharCode(65+c)}</th>\n            ))}\n          </tr>\n        </thead>\n        <tbody>\n          {Array.from({length: rows}).map((_,r)=>(\n            <tr key={r}>\n              <td className=\"p-1 border text-center\">{r+1}</td>\n              {Array.from({length: cols}).map((_,c)=>(\n                <td key={c} className=\"p-0 border\">\n                  {editing && editing.r===r && editing.c===c && editable ? (\n                    <input\n                      ref={inputRef}\n                      className=\"w-full h-8 px-1\"\n                      value={cells?.[r]?.[c] ?? \"\"}\n                      onChange={e=>handleChange(r,c,e.target.value)}\n                      onBlur={()=>setEditing(null)}\n                      onKeyDown={e => { if (e.key==='Enter') setEditing(null); }}\n                    />\n                  ) : (\n                    <div\n                      className=\"h-8 px-1 text-left cursor-text\"\n                      onDoubleClick={()=>editable && setEditing({r,c})}\n                      onClick={()=>editable && setEditing({r,c})}\n                      title={cells?.[r]?.[c] ?? \"\"}\n                    >\n                      {String(rendered(r,c))}\n                    </div>\n                  )}\n                </td>\n              ))}\n            </tr>\n          ))}\n        </tbody>\n      </table>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}